'use client'
import { useEffect } from 'react'

export const C = {
  bg:"var(--bg)",bgS:"var(--bg-s)",bgE:"var(--bg-e)",bgC:"var(--bg-c)",bd:"var(--bd)",bdS:"var(--bd-s)",
  tx:"var(--tx)",txM:"var(--tx-m)",txD:"var(--tx-d)",
  ac:"var(--accent)",acD:"var(--accent-dim)",acB:"var(--accent-border)",
  // Keep legacy keys mapped to accent
  cy:"var(--accent)",cyD:"var(--accent-dim)",cyB:"var(--accent-border)",
  gn:"var(--gn)",gnD:"rgba(52,211,153,0.1)",gnB:"rgba(52,211,153,0.18)",
  am:"var(--am)",amD:"rgba(251,191,36,0.08)",amB:"rgba(251,191,36,0.18)",
  rs:"var(--rs)",rsD:"rgba(251,113,133,0.08)",rsB:"rgba(251,113,133,0.18)",
  pu:"#a78bfa",puD:"rgba(167,139,250,0.08)",puB:"rgba(167,139,250,0.18)",
}
export const MO = "'JetBrains Mono',monospace"
export const SA = "'Instrument Sans',-apple-system,sans-serif"
export const DC = {Engineering:"#b4a0f4",Design:"#e879f9",Operations:"#34d399",Marketing:"#fbbf24",Finance:"#fb7185",HR:"#818cf8",Sales:"#fb923c",Support:"#2dd4bf"}
export const SC = {active:"green",on_leave:"amber",terminated:"rose"}
export const PIC = ["#b4a0f4","#e879f9","#34d399","#fbbf24","#fb7185","#818cf8","#fb923c","#2dd4bf"]
export const DEPTS = ["Engineering","Design","Operations","Marketing","Finance","HR","Sales","Support"]
export const LT = ["Annual","Sick","Parental","Personal","Unpaid"]
export const SHT = [{name:"Morning",time:"06:00–14:00",color:"#fbbf24",h:8},{name:"Day",time:"09:00–17:00",color:"#b4a0f4",h:8},{name:"Evening",time:"14:00–22:00",color:"#e879f9",h:8},{name:"Night",time:"22:00–06:00",color:"#fb7185",h:8}]
export const MODS = [{s:"core",n:"Employee Core",i:"users",a:true},{s:"leave",n:"Leave",i:"calendar"},{s:"shifts",n:"Scheduling",i:"clock"},{s:"compensation",n:"Compensation",i:"dollar"},{s:"performance",n:"Performance",i:"star"},{s:"analytics",n:"Analytics",i:"chart"},{s:"workflows",n:"Workflows",i:"zap"},{s:"policies",n:"Policies",i:"file"}]

export const ini = n => (n||"?").split(" ").map(w=>w[0]).join("").toUpperCase().slice(0,2)
export const isoToday = () => new Date().toISOString().split("T")[0]
export const daysBetween = (a,b) => Math.max(1, Math.ceil((new Date(b)-new Date(a))/86400000)+1)

// Icons
const IC={home:<><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></>,users:<><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4-4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87"/></>,calendar:<><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></>,clock:<><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></>,dollar:<><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"/></>,chart:<><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></>,star:<><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></>,file:<><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></>,zap:<><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></>,shield:<><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></>,settings:<><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 11-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 11-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 112.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 112.83 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z"/></>,check:<><polyline points="20 6 9 17 4 12"/></>,x:<><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></>,plus:<><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></>,search:<><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></>,bell:<><path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 01-3.46 0"/></>,chevL:<><polyline points="15 18 9 12 15 6"/></>,chevR:<><polyline points="9 18 15 12 9 6"/></>,edit:<><path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.12 2.12 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/></>,trash:<><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/></>,play:<><polygon points="5 3 19 12 5 21 5 3"/></>,pause:<><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></>,building:<><rect x="4" y="2" width="16" height="20" rx="2"/><path d="M9 22v-4h6v4"/><line x1="9" y1="6" x2="9" y2="6.01"/><line x1="15" y1="6" x2="15" y2="6.01"/><line x1="9" y1="10" x2="9" y2="10.01"/><line x1="15" y1="10" x2="15" y2="10.01"/></>,logout:<><path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></>,sun:<><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></>,moon:<><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></>}
export function I({n,s=16,c="currentColor"}){return <svg width={s} height={s} viewBox="0 0 24 24" fill="none" stroke={c} strokeWidth="1.7" strokeLinecap="round" strokeLinejoin="round" style={{flexShrink:0}}>{IC[n]}</svg>}

// ─── Logo Component ───
export function BrandLogo({ size = 22 }) {
  return <img src="/logo.png" alt="People.OS" style={{ height: size, width: 'auto', objectFit: 'contain' }} />
}

// Components
export function Bg({children,v="default",s={}}){const m={default:["var(--accent-dim)","var(--accent)","var(--accent-border)"],green:["rgba(52,211,153,0.1)","var(--gn)","rgba(52,211,153,0.18)"],amber:["rgba(251,191,36,0.08)","var(--am)","rgba(251,191,36,0.18)"],rose:["rgba(251,113,133,0.08)","var(--rs)","rgba(251,113,133,0.18)"],purple:["rgba(167,139,250,0.08)","#a78bfa","rgba(167,139,250,0.18)"],dim:["rgba(128,128,128,0.06)","var(--tx-d)","var(--bd)"]};const[bg,c,b]=m[v]||m.default;return <span style={{display:"inline-flex",alignItems:"center",fontFamily:MO,fontSize:10,fontWeight:600,padding:"3px 9px",borderRadius:5,background:bg,color:c,border:`1px solid ${b}`,whiteSpace:"nowrap",...s}}>{children}</span>}
export function Av({name,size=30,color}){const c=color||"#b4a0f4";return <div style={{width:size,height:size,borderRadius:7,background:`${c}12`,border:`1px solid ${c}22`,display:"grid",placeItems:"center",fontFamily:MO,fontSize:size*0.34,fontWeight:700,color:c,flexShrink:0}}>{ini(name)}</div>}
export function Btn({children,v="default",onClick,icon,sz="md",disabled,style:st={}}){const p=sz==="sm"?"5px 11px":sz==="xs"?"3px 8px":"8px 16px";const f=sz==="sm"?11:sz==="xs"?10:12;const vs={default:{background:"var(--bd)",color:"var(--tx)"},primary:{background:"var(--accent)",color:"#fff"},ghost:{background:"transparent",color:"var(--tx-m)",border:`1px solid var(--bd)`},danger:{background:"rgba(251,113,133,0.08)",color:"var(--rs)",border:"1px solid rgba(251,113,133,0.18)"}};return <button onClick={disabled?undefined:onClick} style={{display:"inline-flex",alignItems:"center",gap:5,fontFamily:MO,fontSize:f,fontWeight:600,padding:p,borderRadius:7,border:"none",cursor:disabled?"not-allowed":"pointer",opacity:disabled?0.4:1,...(vs[v]||vs.default),...st}}>{icon&&<I n={icon} s={f+2}/>}{children}</button>}
export function Inp({label,value,onChange,type="text",placeholder,options,textarea,required}){const s={padding:"8px 10px",borderRadius:7,border:"1px solid var(--bd)",background:"var(--bg-e)",color:"var(--tx)",fontSize:13,outline:"none",fontFamily:SA,width:"100%"};return <div style={{display:"flex",flexDirection:"column",gap:4}}>{label&&<label style={{fontSize:11,color:"var(--tx-d)",fontWeight:500}}>{label}{required&&<span style={{color:"var(--rs)"}}>*</span>}</label>}{options?<select value={value} onChange={e=>onChange(e.target.value)} style={s}>{options.map(o=>{const vl=typeof o==="string"?o:o.value;const lb=typeof o==="string"?o:o.label;return <option key={vl} value={vl}>{lb}</option>})}</select>:textarea?<textarea value={value} onChange={e=>onChange(e.target.value)} placeholder={placeholder} rows={3} style={{...s,resize:"vertical"}}/>:<input type={type} value={value} onChange={e=>onChange(e.target.value)} placeholder={placeholder} style={s}/>}</div>}
export function Tog({on,onToggle,disabled}){return <button onClick={disabled?undefined:onToggle} style={{width:38,height:20,borderRadius:10,background:on?"var(--accent)":"var(--bd)",border:"none",cursor:disabled?"default":"pointer",padding:2,opacity:disabled?0.5:1,flexShrink:0}}><div style={{width:16,height:16,borderRadius:"50%",background:"#fff",transform:on?"translateX(18px)":"translateX(0)",transition:"transform 0.2s"}}/></button>}
export function Modal({open,onClose,title,children,w=500}){if(!open)return null;return <div style={{position:"fixed",inset:0,zIndex:1000,display:"grid",placeItems:"center",background:"rgba(0,0,0,0.65)",backdropFilter:"blur(6px)"}} onClick={onClose}><div onClick={e=>e.stopPropagation()} style={{background:"var(--bg-c)",border:"1px solid var(--bd)",borderRadius:14,width:w,maxWidth:"92vw",maxHeight:"85vh",overflow:"auto",padding:24}}><div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:18}}><h3 style={{fontSize:15,fontWeight:700}}>{title}</h3><button onClick={onClose} style={{background:"none",border:"none",color:"var(--tx-d)",cursor:"pointer"}}><I n="x" s={16}/></button></div>{children}</div></div>}
export function Toast({toast}){if(!toast)return null;const ic=toast.type==="success"?"var(--gn)":"var(--rs)";return <div style={{position:"fixed",bottom:24,right:24,zIndex:2000,background:"var(--bg-c)",border:`1px solid ${ic}33`,borderRadius:10,padding:"10px 16px",display:"flex",alignItems:"center",gap:8,boxShadow:"0 8px 32px rgba(0,0,0,0.4)"}}><I n={toast.type==="success"?"check":"bell"} s={14} c={ic}/><span style={{fontSize:12,fontWeight:500}}>{toast.message}</span></div>}
export function Tbs({tabs,active,onChange}){return <div style={{display:"flex",borderBottom:"1px solid var(--bd)",marginBottom:20}}>{tabs.map(t=><button key={t.id} onClick={()=>onChange(t.id)} style={{padding:"9px 18px",fontSize:12,fontWeight:500,border:"none",background:"none",color:active===t.id?"var(--tx)":"var(--tx-d)",cursor:"pointer",borderBottom:`2px solid ${active===t.id?"var(--accent)":"transparent"}`,marginBottom:-1,fontFamily:SA}}>{t.label}{t.count!=null&&<span style={{marginLeft:6,fontFamily:MO,fontSize:9,background:active===t.id?"var(--accent-dim)":"var(--bg-e)",color:active===t.id?"var(--accent)":"var(--tx-d)",padding:"2px 6px",borderRadius:4,fontWeight:600}}>{t.count}</span>}</button>)}</div>}
export function Stt({label,value,icon}){return <div style={{background:"var(--bg-e)",border:"1px solid var(--bd)",borderRadius:10,padding:"16px 18px"}}><div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10}}><span style={{fontSize:10,color:"var(--tx-d)",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.07em"}}>{label}</span>{icon&&<I n={icon} s={14} c="var(--tx-d)"/>}</div><span style={{fontFamily:MO,fontSize:24,fontWeight:700,letterSpacing:"-0.04em"}}>{value}</span></div>}
export function Tbl({cols,data,onRow,empty}){if(!data.length)return empty||<div style={{padding:24,textAlign:"center",color:"var(--tx-d)",fontSize:12,background:"var(--bg-e)",border:"1px solid var(--bd)",borderRadius:10}}>No data yet</div>;return <div style={{border:"1px solid var(--bd)",borderRadius:10,overflow:"hidden"}}><div style={{overflowX:"auto"}}><table style={{width:"100%",borderCollapse:"collapse",fontSize:12}}><thead><tr style={{background:"var(--bg-e)",borderBottom:"1px solid var(--bd)"}}>{cols.map((c,i)=><th key={i} style={{padding:"8px 14px",textAlign:"left",fontWeight:600,color:"var(--tx-d)",fontSize:10,textTransform:"uppercase",letterSpacing:"0.06em",whiteSpace:"nowrap"}}>{c.label}</th>)}</tr></thead><tbody>{data.map((r,i)=><tr key={r.id||i} onClick={()=>onRow?.(r)} style={{borderBottom:"1px solid var(--bd-s)",cursor:onRow?"pointer":"default"}} onMouseEnter={e=>e.currentTarget.style.background="var(--bg-e)"} onMouseLeave={e=>e.currentTarget.style.background="transparent"}>{cols.map((c,j)=><td key={j} style={{padding:"10px 14px",color:"var(--tx)"}}>{c.render?c.render(r):r[c.key]}</td>)}</tr>)}</tbody></table></div></div>}
export function Ety({icon,message,action,onAction}){return <div style={{background:"var(--bg-e)",border:"1px solid var(--bd)",borderRadius:10,padding:"40px 20px",textAlign:"center"}}><I n={icon} s={28} c="var(--tx-d)"/><p style={{fontSize:13,color:"var(--tx-d)",marginTop:10}}>{message}</p>{action&&<Btn v="primary" sz="sm" onClick={onAction} style={{marginTop:12}}>{action}</Btn>}</div>}
