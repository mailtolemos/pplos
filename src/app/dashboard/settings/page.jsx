'use client'
import { useState } from 'react'
import { useData } from '@/components/data-provider'
import { C, MO, SA, I, Bg, Btn, Tbs, Tog, MODS } from '@/components/ui'

export default function SettingsPage(){const{tenant,emps,updTenant}=useData();const[tab,setTab]=useState('general');const[ek,setEk]=useState(null);const[ev,setEv]=useState('');return<div><h1 style={{fontSize:20,fontWeight:700,marginBottom:20}}>Settings</h1><Tbs tabs={[{id:'general',label:'General'},{id:'modules',label:'Modules'},{id:'billing',label:'Billing'}]} active={tab} onChange={setTab}/>{tab==='general'&&<div style={{background:C.bgE,border:`1px solid ${C.bd}`,borderRadius:10,padding:20,maxWidth:520}}>{[['name','Company',tenant.name],['slug','Subdomain',tenant.slug],['plan','Plan',tenant.plan]].map(([k,l,v])=><div key={k} style={{display:'flex',justifyContent:'space-between',alignItems:'center',padding:'10px 0',borderBottom:`1px solid ${C.bdS}`}}><span style={{fontSize:12,color:C.txD}}>{l}</span>{ek===k?<div style={{display:'flex',gap:4}}><input value={ev} onChange={e=>setEv(e.target.value)} autoFocus style={{padding:'4px 8px',borderRadius:5,border:`1px solid ${C.cy}`,background:C.bgC,color:C.tx,fontSize:12,fontFamily:MO,width:140,outline:'none'}}/><Btn v="primary" sz="xs" onClick={()=>{updTenant({[k]:ev});setEk(null)}}>Save</Btn><Btn v="ghost" sz="xs" onClick={()=>setEk(null)}>✕</Btn></div>:<div style={{display:'flex',alignItems:'center',gap:6}}><span style={{fontSize:12,fontWeight:500,fontFamily:MO}}>{v}</span><button onClick={()=>{setEk(k);setEv(v)}} style={{background:'none',border:'none',cursor:'pointer',color:C.txD}}><I n="edit" s={12}/></button></div>}</div>)}</div>}{tab==='modules'&&<div style={{display:'grid',gridTemplateColumns:'repeat(2,1fr)',gap:10,maxWidth:600}}>{MODS.map(m=>{const mods=tenant.enabled_modules||[];const on=mods.includes(m.s);return<div key={m.s} style={{background:C.bgE,border:`1px solid ${on?C.cyB:C.bd}`,borderRadius:9,padding:14,display:'flex',justifyContent:'space-between',alignItems:'center'}}><div style={{display:'flex',alignItems:'center',gap:8}}><I n={m.i} s={15} c={on?C.cy:C.txD}/><div><div style={{fontSize:12,fontWeight:500}}>{m.n}</div>{m.a&&<div style={{fontSize:9,color:C.txD}}>Always on</div>}</div></div><Tog on={on} onToggle={()=>{if(!m.a)updTenant({enabled_modules:on?mods.filter(x=>x!==m.s):[...mods,m.s]})}} disabled={m.a}/></div>})}</div>}{tab==='billing'&&<div style={{background:C.bgE,border:`1px solid ${C.bd}`,borderRadius:10,padding:20,maxWidth:480}}><Bg v="green" s={{marginBottom:8}}>{tenant.plan}</Bg><div style={{fontFamily:MO,fontSize:26,fontWeight:700,marginTop:8}}>€{tenant.plan==='starter'?emps.length*4:tenant.plan==='growth'?emps.length*8:'custom'}<span style={{fontSize:12,color:C.txD,fontWeight:400}}>/mo</span></div><div style={{fontSize:11,color:C.txD,marginTop:4}}>{emps.length} × €{tenant.plan==='starter'?4:8}/user</div></div>}</div>}
